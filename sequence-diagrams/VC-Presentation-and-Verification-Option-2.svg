<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="2329" height="905" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Title: VC Presentation and Verification - Option 2 (Anonymous)
Participant User
Participant DAA
Participant Cloud Agent
Participant DAP Agency
Participant SP
User -> SP: User wants a service from SP
SP -> User: Wants proof and requests User to connect DAA via SP_ID
User -> DAA: Provide SP_ID to DAA
DAA -> Cloud Agent: Pass SP_ID to Cloud Agent to connect with SP
Cloud Agent -> SP: Invites SP for DIDComm connection (mutual authentication)
Cloud Agent -> SP: Generate and exchange pairwise peer DIDs for DIDcomm connection. \n Connection established
SP -> Cloud Agent: Request VC presentation (provide VC schema and nonce)
Cloud Agent -> Cloud Agent: lookup VC metadata by VC schema\n and other criteria
Cloud Agent -> DAA: Let user select the VC to be presented to SP 
DAA -> User: show selectable VCs
User --> DAA: user selects & approves VC to be presented
DAA -> Cloud Agent: Send the selected VC & authenticate with USER_FIDO_PK for providing consent
Cloud Agent -> Cloud Agent: Verify that no privacy leak exists
Cloud Agent -> Cloud Agent: Retrieve VC and prepare VC presentation to SP
Cloud Agent -> Cloud Agent: Generate one-time use key pair DAP_USER_ID_TMPx_PK/SK
Cloud Agent -> Cloud Agent: Sign VP using DAP_USER_ID_TMPx_SK
Cloud Agent -> SP: Present VC or selected values to SP 
SP -> DAP Agency: SP receives the VC or selected values and verifies VC\n by querying DAP for Issuer public keys (ISSUER_ID_PK)
]]></source><desc>VC Presentation and Verification - Option 2 (Anonymous)</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="538" height="28" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="15" y="28" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="15">VC Presentation and Verification - Option 2 (Anonymous)</tspan></text></g><g class="actor"><rect x="10" y="48" width="58.400001525878906" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="71" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">User</tspan></text></g><g class="actor"><rect x="10" y="847.6000022888184" width="58.400001525878906" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="870.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">User</tspan></text></g><line x1="39.20000076293945" x2="39.20000076293945" y1="86" y2="847.6000022888184" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="438.00001335144043" y="48" width="48.79999923706055" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="448.00001335144043" y="71" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="448.00001335144043">DAA</tspan></text></g><g class="actor"><rect x="438.00001335144043" y="847.6000022888184" width="48.79999923706055" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="448.00001335144043" y="870.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="448.00001335144043">DAA</tspan></text></g><line x1="462.4000129699707" x2="462.4000129699707" y1="86" y2="847.6000022888184" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="1139.6000137329102" y="48" width="125.5999984741211" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1149.6000137329102" y="71" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1149.6000137329102">Cloud Agent</tspan></text></g><g class="actor"><rect x="1139.6000137329102" y="847.6000022888184" width="125.5999984741211" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1149.6000137329102" y="870.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1149.6000137329102">Cloud Agent</tspan></text></g><line x1="1202.4000129699707" x2="1202.4000129699707" y1="86" y2="847.6000022888184" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="1693.2000007629395" y="48" width="116" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1703.2000007629395" y="71" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1703.2000007629395">DAP Agency</tspan></text></g><g class="actor"><rect x="1693.2000007629395" y="847.6000022888184" width="116" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1703.2000007629395" y="870.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1703.2000007629395">DAP Agency</tspan></text></g><line x1="1751.2000007629395" x2="1751.2000007629395" y1="86" y2="847.6000022888184" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="2260.3999881744385" y="48" width="39.20000076293945" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="2270.3999881744385" y="71" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="2270.3999881744385">SP</tspan></text></g><g class="actor"><rect x="2260.3999881744385" y="847.6000022888184" width="39.20000076293945" height="38" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="2270.3999881744385" y="870.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="2270.3999881744385">SP</tspan></text></g><line x1="2279.999988555908" x2="2279.999988555908" y1="86" y2="847.6000022888184" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="signal"><text x="1025.2000007629395" y="115" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1025.2000007629395">User wants a service from SP</tspan></text><line x1="39.20000076293945" x2="2279.999988555908" y1="124" y2="124" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="900.3999824523926" y="153" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900.3999824523926">Wants proof and requests User to connect DAA via SP_ID</tspan></text><line x1="2279.999988555908" x2="39.20000076293945" y1="162" y2="162" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="154.80000686645508" y="191" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="154.80000686645508">Provide SP_ID to DAA</tspan></text><line x1="39.20000076293945" x2="462.4000129699707" y1="200" y2="200" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="621.2000160217285" y="229" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="621.2000160217285">Pass SP_ID to Cloud Agent to connect with SP</tspan></text><line x1="462.4000129699707" x2="1202.4000129699707" y1="238" y2="238" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1467.5999946594238" y="267" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1467.5999946594238">Invites SP for DIDComm connection (mutual authentication)</tspan></text><line x1="1202.4000129699707" x2="2279.999988555908" y1="276" y2="276" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1433.9999885559082" y="295.3999996185303" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1433.9999885559082">Generate and exchange pairwise peer DIDs for DIDcomm connection.</tspan><tspan dy="1.2em" x="1433.9999885559082">Connection established</tspan></text><line x1="1202.4000129699707" x2="2279.999988555908" y1="333.20000076293945" y2="333.20000076293945" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1486.800006866455" y="362.20000076293945" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1486.800006866455">Request VC presentation (provide VC schema and nonce)</tspan></text><line x1="2279.999988555908" x2="1202.4000129699707" y1="371.20000076293945" y2="371.20000076293945" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1227.4000129699707" y="414.8000011444092" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1227.4000129699707">lookup VC metadata by VC schema</tspan><tspan dy="1.2em" x="1227.4000129699707">and other criteria</tspan></text><line x1="1202.4000129699707" x2="1222.4000129699707" y1="391.20000076293945" y2="391.20000076293945" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1222.4000129699707" y1="391.20000076293945" y2="433.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1202.4000129699707" y1="433.4000015258789" y2="433.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="621.2000160217285" y="457.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="621.2000160217285">Let user select the VC to be presented to SP</tspan></text><line x1="1202.4000129699707" x2="462.4000129699707" y1="466.4000015258789" y2="466.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="159.6000099182129" y="495.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="159.6000099182129">show selectable VCs</tspan></text><line x1="462.4000129699707" x2="39.20000076293945" y1="504.4000015258789" y2="504.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="49.20000076293945" y="533.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="49.20000076293945">user selects &amp; approves VC to be presented</tspan></text><line x1="39.20000076293945" x2="462.4000129699707" y1="542.4000015258789" y2="542.4000015258789" style="stroke-width: 2px; stroke-dasharray: 6px, 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="472.4000129699707" y="571.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="472.4000129699707">Send the selected VC &amp; authenticate with USER_FIDO_PK for providing consent</tspan></text><line x1="462.4000129699707" x2="1202.4000129699707" y1="580.4000015258789" y2="580.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1227.4000129699707" y="614.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1227.4000129699707">Verify that no privacy leak exists</tspan></text><line x1="1202.4000129699707" x2="1222.4000129699707" y1="600.4000015258789" y2="600.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1222.4000129699707" y1="600.4000015258789" y2="623.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1202.4000129699707" y1="623.4000015258789" y2="623.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1227.4000129699707" y="652.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1227.4000129699707">Retrieve VC and prepare VC presentation to SP</tspan></text><line x1="1202.4000129699707" x2="1222.4000129699707" y1="638.4000015258789" y2="638.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1222.4000129699707" y1="638.4000015258789" y2="661.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1202.4000129699707" y1="661.4000015258789" y2="661.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1227.4000129699707" y="690.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1227.4000129699707">Generate one-time use key pair DAP_USER_ID_TMPx_PK/SK</tspan></text><line x1="1202.4000129699707" x2="1222.4000129699707" y1="676.4000015258789" y2="676.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1222.4000129699707" y1="676.4000015258789" y2="699.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1202.4000129699707" y1="699.4000015258789" y2="699.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1227.4000129699707" y="728.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1227.4000129699707">Sign VP using DAP_USER_ID_TMPx_SK</tspan></text><line x1="1202.4000129699707" x2="1222.4000129699707" y1="714.4000015258789" y2="714.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1222.4000129699707" y1="714.4000015258789" y2="737.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="1222.4000129699707" x2="1202.4000129699707" y1="737.4000015258789" y2="737.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1573.2000007629395" y="761.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1573.2000007629395">Present VC or selected values to SP</tspan></text><line x1="1202.4000129699707" x2="2279.999988555908" y1="770.4000015258789" y2="770.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1761.2000007629395" y="789.8000011444092" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1761.2000007629395">SP receives the VC or selected values and verifies VC</tspan><tspan dy="1.2em" x="1761.2000007629395">by querying DAP for Issuer public keys (ISSUER_ID_PK)</tspan></text><line x1="2279.999988555908" x2="1751.2000007629395" y1="827.6000022888184" y2="827.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>