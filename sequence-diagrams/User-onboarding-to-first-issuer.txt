Title: User onboarding to first issuer
Participant User
Participant DAA
Participant Issuer
Participant Cloud Agent
Participant DAP
Participant GADI
User -> Issuer: I want to get Digital Address (provide authentication + accept T&C)\n Issuer has ID-proofed user before
Issuer -> Issuer: lookup ID-Attribs for that user
Issuer -> Issuer: compute HIDA = hash(ID-Attribs)
Issuer -> DAP: securely send HIDA
DAP -> GADI: lookup TA_USER_ISSUER for HIDA
GADI -> GADI: lookup TA for HIDA
GADI -> GADI: if TA not found: generate TA = random
GADI -> GADI: store HIDA, HomeDAP-ID=DAP-ID, TA (in DLT)
GADI --> DAP: No conflict with TA. \nReturn TA_USER_ISSUER = hash(TA, ISSUER_ID)
DAP -> DAP: Create DA and DAP_USER_ID 
DAP -> DAP: Remember (TA_USER_ISSUER, DAP_USER_ID) in DLT
DAP -> GADI: Send HIDA, TA_USER_ISSUER, DA to notify about DA
GADI -> GADI: Remember DA exists for HIDA\n(don't store DA!)
GADI --> DAP: Success
DAP --> Issuer: Return TA_USER_ISSUER, DAP_USER_ID, DA
Issuer -> Issuer: Remember DA and DAP_USER_ID for user in userDB
Issuer -> Issuer: Creates QR code (DA, Issuer-URL?)
Issuer -> User: presents or sends the QR code in Web interface/Issuer PC
User -> DAA: Scans the QR code and extracts DA+IssuerURL
DAA -> User: Do you accept DA?
User -> DAA: DA accepted
DAA -> DAP: Register FIDO Authenticator for this user and DA to the DAP
DAP -> DAP: Remember create and store VC(USER_FIDO_PK, DAP_USER_ID)
DAP --> DAA: acknowledge successful FIDO registration
DAA -> DAP: ID proofing starts on the device and extracts the user info
DAP -> DAP: If successful: Mark ID proofing as complete for this DAP_USER_ID
DAP --> DAA: Success
DAA -> Issuer: Send Verified User Attributes + DA to IssuerURL
Issuer -> Issuer: Verifies User Attributes against userDB identified by DA
Issuer -> Issuer: create VC(TA_USER_ISSUER, Validation Succeeded)
Issuer -> DAA: validation succeeded for DA+VC(TA_USER_ISSUER, Validation Succeeded)
DAA -> DAA: Remember TA_USER_ISSUER, HIDA
DAA -> Issuer: Accept DA
Issuer --> DAA: OK
DAA -> DAP: send VC(TA_USER_ISSUER, Validation Succeeded)
DAA -> Cloud Agent: request to generate DAP_USER_ID_PK/SK (use FIDO auth)
Cloud Agent -> Cloud Agent: Create VC(DAP_USER_ID_PK, USER_FIDO_PK)
Cloud Agent -> DAP: Send VC(DAP_USER_ID_PK, USER_FIDO_PK)
DAP --> Cloud Agent: Success
Cloud Agent --> DAA: Success
DAA -> User: Setup Completed
