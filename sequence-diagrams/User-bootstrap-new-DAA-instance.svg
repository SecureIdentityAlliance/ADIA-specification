<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="2955" height="1135" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Title: User Bootstraps New DAA Instance
Participant User
Participant DAA
Participant Issuer
Participant DAP
Participant GADI
User -> Issuer: I want to recover my Digital Address because lost device
Issuer -> Issuer: lookup ID-Attribs for that user
Issuer -> Issuer: compute HIDA = hash(ID-Attribs)
Issuer -> DAP: securely send HIDA
DAP -> DAP: lookup TA_USER_ISSUER for HIDA
DAP -> GADI: if TA_USER_ISSUER not found: lookup TA_USER_ISSUER for HIDA
GADI -> GADI: lookup TA for HIDA (found)
GADI --> DAP: Return found on Home_DAP_ID
DAP --> Issuer: User exists in other DAP (Home_DAP_ID,Home DAP Name)
Issuer --> User: Your DA exists in Home DAP Name.  Use your existing DAA.
User -> Issuer: Want to to bootstrap new phone
Issuer -> Issuer: Lookup DA for HIDA
Issuer -> Issuer: Create QR code (DA, Issuer-URL?)
Issuer -> User: presents or sends the QR code in Web interface/Issuer PC
User -> DAA: Scans the QR code and extracts DA+IssuerURL
DAA -> DAP: ID proofing starts on the device and extracts the user info 
DAP --> DAA: Success
DAA -> Issuer: Send Verified User Attributes + DA to IssuerURL
Issuer -> Issuer: Verifies User Attributes against userDB identified by DA
Issuer -> Issuer: check whether VC(TA_USER_ISSUER, Validation Succeeded) exists (it should)
Issuer -> DAA: validation succeeded for DA+VC(TA_USER_ISSUER, Validation Succeeded)
DAA -> Issuer: Accept DA
Issuer --> DAA: OK
DAA -> DAP: Register FIDO Authenticator for this DA to the DAP+send VC (implicitly: User accepted DA)
DAP -> DAP: Saves the FIDO public key against TA_USER_ISSUER - replacing old FIDO public key (for lost device
]]></source><desc>User Bootstraps New DAA Instance</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="291.5" height="28.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="30" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">User Bootstraps New DAA Instance</tspan></text></g><g class="actor"><rect x="10" y="48.75" width="55.1875" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="20" y="73.75" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">User</tspan></text></g><g class="actor"><rect x="10" y="1076.25" width="55.1875" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="20" y="1101.25" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">User</tspan></text></g><line x1="37.59375" x2="37.59375" y1="87.5" y2="1076.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="412.0625" y="48.75" width="47.59375" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="422.0625" y="73.75" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="422.0625">DAA</tspan></text></g><g class="actor"><rect x="412.0625" y="1076.25" width="47.59375" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="422.0625" y="1101.25" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="422.0625">DAA</tspan></text></g><line x1="435.859375" x2="435.859375" y1="87.5" y2="1076.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1017.65625" y="48.75" width="72.78125" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1027.65625" y="73.75" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1027.65625">Issuer</tspan></text></g><g class="actor"><rect x="1017.65625" y="1076.25" width="72.78125" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1027.65625" y="1101.25" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1027.65625">Issuer</tspan></text></g><line x1="1054.046875" x2="1054.046875" y1="87.5" y2="1076.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1713.0234375" y="48.75" width="46.390625" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1723.0234375" y="73.75" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1723.0234375">DAP</tspan></text></g><g class="actor"><rect x="1713.0234375" y="1076.25" width="46.390625" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1723.0234375" y="1101.25" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1723.0234375">DAP</tspan></text></g><line x1="1736.21875" x2="1736.21875" y1="87.5" y2="1076.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="2601.921875" y="48.75" width="55.1875" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="2611.921875" y="73.75" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2611.921875">GADI</tspan></text></g><g class="actor"><rect x="2601.921875" y="1076.25" width="55.1875" height="38.75" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="2611.921875" y="1101.25" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2611.921875">GADI</tspan></text></g><line x1="2629.515625" x2="2629.515625" y1="87.5" y2="1076.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="signal"><text x="299.5078125" y="118.125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="299.5078125">I want to recover my Digital Address because lost device</tspan></text><line x1="37.59375" x2="1054.046875" y1="126.25" y2="126.25" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1079.046875" y="160.625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1079.046875">lookup ID-Attribs for that user</tspan></text><line x1="1054.046875" x2="1074.046875" y1="146.25" y2="146.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1074.046875" y1="146.25" y2="170" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1054.046875" y1="170" y2="170" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1079.046875" y="199.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1079.046875">compute HIDA = hash(ID-Attribs)</tspan></text><line x1="1054.046875" x2="1074.046875" y1="185" y2="185" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1074.046875" y1="185" y2="208.75" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1054.046875" y1="208.75" y2="208.75" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1315.359375" y="234.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1315.359375">securely send HIDA</tspan></text><line x1="1054.046875" x2="1736.21875" y1="242.5" y2="242.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1761.21875" y="276.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1761.21875">lookup TA_USER_ISSUER for HIDA</tspan></text><line x1="1736.21875" x2="1756.21875" y1="262.5" y2="262.5" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1756.21875" x2="1756.21875" y1="262.5" y2="286.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1756.21875" x2="1736.21875" y1="286.25" y2="286.25" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1922.7578125" y="311.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1922.7578125">if TA_USER_ISSUER not found: lookup TA_USER_ISSUER for HIDA</tspan></text><line x1="1736.21875" x2="2629.515625" y1="320" y2="320" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="2654.515625" y="354.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2654.515625">lookup TA for HIDA (found)</tspan></text><line x1="2629.515625" x2="2649.515625" y1="340" y2="340" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="2649.515625" x2="2649.515625" y1="340" y2="363.75" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="2649.515625" x2="2629.515625" y1="363.75" y2="363.75" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="2064.109375" y="389.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2064.109375">Return found on Home_DAP_ID</tspan></text><line x1="2629.515625" x2="1736.21875" y1="397.5" y2="397.5" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1166.4140625" y="428.125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1166.4140625">User exists in other DAP (Home_DAP_ID,Home DAP Name)</tspan></text><line x1="1736.21875" x2="1054.046875" y1="436.25" y2="436.25" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="304.53125" y="466.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="303.28125">Your DA exists in Home DAP Name.  Use your existing DAA.</tspan></text><line x1="1054.046875" x2="37.59375" y1="475" y2="475" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="413.8671875" y="505.625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="413.8671875">Want to to bootstrap new phone</tspan></text><line x1="37.59375" x2="1054.046875" y1="513.75" y2="513.75" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1079.046875" y="548.125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1079.046875">Lookup DA for HIDA</tspan></text><line x1="1054.046875" x2="1074.046875" y1="533.75" y2="533.75" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1074.046875" y1="533.75" y2="557.5" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1054.046875" y1="557.5" y2="557.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1079.046875" y="586.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1079.046875">Create QR code (DA, Issuer-URL?)</tspan></text><line x1="1054.046875" x2="1074.046875" y1="572.5" y2="572.5" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1074.046875" y1="572.5" y2="596.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1054.046875" y1="596.25" y2="596.25" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="299.5078125" y="621.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="299.5078125">presents or sends the QR code in Web interface/Issuer PC</tspan></text><line x1="1054.046875" x2="37.59375" y1="630" y2="630" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="47.59375" y="660.625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="47.59375">Scans the QR code and extracts DA+IssuerURL</tspan></text><line x1="37.59375" x2="435.859375" y1="668.75" y2="668.75" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="826.53125" y="699.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="826.53125">ID proofing starts on the device and extracts the user info</tspan></text><line x1="435.859375" x2="1736.21875" y1="707.5" y2="707.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1055.25" y="738.125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1055.25">Success</tspan></text><line x1="1736.21875" x2="435.859375" y1="746.25" y2="746.25" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="538.2265625" y="776.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="538.2265625">Send Verified User Attributes + DA to IssuerURL</tspan></text><line x1="435.859375" x2="1054.046875" y1="785" y2="785" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1080.296875" y="819.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1079.046875">Verifies User Attributes against userDB identified by DA</tspan></text><line x1="1054.046875" x2="1074.046875" y1="805" y2="805" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1074.046875" y1="805" y2="828.75" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1054.046875" y1="828.75" y2="828.75" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1079.046875" y="858.125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1079.046875">check whether VC(TA_USER_ISSUER, Validation Succeeded) exists (it should)</tspan></text><line x1="1054.046875" x2="1074.046875" y1="843.75" y2="843.75" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1074.046875" y1="843.75" y2="867.5" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1074.046875" x2="1054.046875" y1="867.5" y2="867.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="445.859375" y="893.125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="445.859375">validation succeeded for DA+VC(TA_USER_ISSUER, Validation Succeeded)</tspan></text><line x1="1054.046875" x2="435.859375" y1="901.25" y2="901.25" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="705.390625" y="931.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="704.140625">Accept DA</tspan></text><line x1="435.859375" x2="1054.046875" y1="940" y2="940" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="736.15625" y="970.625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="736.15625">OK</tspan></text><line x1="1054.046875" x2="435.859375" y1="978.75" y2="978.75" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="694.578125" y="1009.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="694.578125">Register FIDO Authenticator for this DA to the DAP+send VC (implicitly: User accepted DA)</tspan></text><line x1="435.859375" x2="1736.21875" y1="1017.5" y2="1017.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1761.21875" y="1051.875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1761.21875">Saves the FIDO public key against TA_USER_ISSUER - replacing old FIDO public key (for lost device</tspan></text><line x1="1736.21875" x2="1756.21875" y1="1037.5" y2="1037.5" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1756.21875" x2="1756.21875" y1="1037.5" y2="1061.25" stroke="#000000" fill="none" style="stroke-width: 2;"></line><line x1="1756.21875" x2="1736.21875" y1="1061.25" y2="1061.25" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>