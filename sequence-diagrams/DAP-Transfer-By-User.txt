title User Changes Home DAP

participant User
participant Home DAP
participant DLT-1
participant DAP-2
participant DLT-2
participant Credential Issuer
participant VC Store


User->Home DAP: Submit Transfer request
Home DAP-> User: Link DA, USER_DAP_ID
Home DAP->DAP-2: Initiate Transfer request
DAP-2->User: Consent request
User-->DAP-2: Approve
DAP-2->Home DAP: Transfer DA and VC Metadata
Home DAP-->DAP-2: Send DA and VC Metadata
DAP-2-->DAP-2: Modify Home DAP Suffix
DAP-2->User: Notify Home DAP Transfer with modified Suffix 
User-->User: DA with modified Home DAP Suffix
User->Credential Issuer: Flow 2: Request VC
Credential Issuer-> User: TA Collision + Link DA
Credential Issuer->DAP-2: Resolve HOME_DAP_ID from DA
DAP-2->DLT-2: Lookup DAP Suffix in DA
DLT-2->DAP-2: Resolved DAP_AGENCY_ID, DAP_DA
DAP-2->Credential Issuer: Resolved HOME_DAP_ID, DAP_DA
Credential Issuer->VC Store: Issue Credential
Credential Issuer-->DAP-2: Save Credential Metadata (DA, USER_DAP_ID, ISSUER_ID)
DAP-2-->DAP-2: Save VC Metadata to modified Home DAP
DAP-2--> DLT-2: Save VC Metadata (DA,USER_DAP_ID, ISSUER_ID, DAP_AGENCY_ID)
DAP-2->User: VC Notification